m = {{'arisu', 'koharu', 'yoshino', 'yukimi', 'yumi'},	
{'arisu', 'koharu', 'yoshino', 'yumi', 'yukimi'},
{'arisu', 'koharu', 'yukimi', 'yoshino', 'yumi'},
{'arisu', 'koharu', 'yukimi', 'yumi', 'yoshino'},
{'arisu', 'koharu', 'yumi', 'yoshino', 'yukimi'},
{'arisu', 'koharu', 'yumi', 'yukimi', 'yoshino'},
{'arisu', 'yoshino', 'koharu', 'yukimi', 'yumi'},
{'arisu', 'yoshino', 'koharu', 'yumi', 'yukimi'},
{'arisu', 'yoshino', 'yukimi', 'koharu', 'yumi'},
{'arisu', 'yoshino', 'yukimi', 'yumi', 'koharu'},
{'arisu', 'yoshino', 'yumi', 'koharu', 'yukimi'},
{'arisu', 'yoshino', 'yumi', 'yukimi', 'koharu'},
{'arisu', 'yukimi', 'koharu', 'yoshino', 'yumi'},
{'arisu', 'yukimi', 'koharu', 'yumi', 'yoshino'},
{'arisu', 'yukimi', 'yoshino', 'koharu', 'yumi'},
{'arisu', 'yukimi', 'yoshino', 'yumi', 'koharu'},
{'arisu', 'yukimi', 'yumi', 'koharu', 'yoshino'},
{'arisu', 'yukimi', 'yumi', 'yoshino', 'koharu'},
{'arisu', 'yumi', 'koharu', 'yoshino', 'yukimi'},
{'arisu', 'yumi', 'koharu', 'yukimi', 'yoshino'},
{'arisu', 'yumi', 'yoshino', 'koharu', 'yukimi'},
{'arisu', 'yumi', 'yoshino', 'yukimi', 'koharu'},
{'arisu', 'yumi', 'yukimi', 'koharu', 'yoshino'},
{'arisu', 'yumi', 'yukimi', 'yoshino', 'koharu'},
{'koharu', 'arisu', 'yoshino', 'yukimi', 'yumi'},
{'koharu', 'arisu', 'yoshino', 'yumi', 'yukimi'},
{'koharu', 'arisu', 'yukimi', 'yoshino', 'yumi'},
{'koharu', 'arisu', 'yukimi', 'yumi', 'yoshino'},
{'koharu', 'arisu', 'yumi', 'yoshino', 'yukimi'},
{'koharu', 'arisu', 'yumi', 'yukimi', 'yoshino'},
{'koharu', 'yoshino', 'arisu', 'yukimi', 'yumi'},
{'koharu', 'yoshino', 'arisu', 'yumi', 'yukimi'},
{'koharu', 'yoshino', 'yukimi', 'arisu', 'yumi'},
{'koharu', 'yoshino', 'yukimi', 'yumi', 'arisu'},
{'koharu', 'yoshino', 'yumi', 'arisu', 'yukimi'},
{'koharu', 'yoshino', 'yumi', 'yukimi', 'arisu'},
{'koharu', 'yukimi', 'arisu', 'yoshino', 'yumi'},
{'koharu', 'yukimi', 'arisu', 'yumi', 'yoshino'},
{'koharu', 'yukimi', 'yoshino', 'arisu', 'yumi'},
{'koharu', 'yukimi', 'yoshino', 'yumi', 'arisu'},
{'koharu', 'yukimi', 'yumi', 'arisu', 'yoshino'},
{'koharu', 'yukimi', 'yumi', 'yoshino', 'arisu'},
{'koharu', 'yumi', 'arisu', 'yoshino', 'yukimi'},
{'koharu', 'yumi', 'arisu', 'yukimi', 'yoshino'},
{'koharu', 'yumi', 'yoshino', 'arisu', 'yukimi'},
{'koharu', 'yumi', 'yoshino', 'yukimi', 'arisu'},
{'koharu', 'yumi', 'yukimi', 'arisu', 'yoshino'},
{'koharu', 'yumi', 'yukimi', 'yoshino', 'arisu'},
{'yoshino', 'arisu', 'koharu', 'yukimi', 'yumi'},
{'yoshino', 'arisu', 'koharu', 'yumi', 'yukimi'},
{'yoshino', 'arisu', 'yukimi', 'koharu', 'yumi'},
{'yoshino', 'arisu', 'yukimi', 'yumi', 'koharu'},
{'yoshino', 'arisu', 'yumi', 'koharu', 'yukimi'},
{'yoshino', 'arisu', 'yumi', 'yukimi', 'koharu'},
{'yoshino', 'koharu', 'arisu', 'yukimi', 'yumi'},
{'yoshino', 'koharu', 'arisu', 'yumi', 'yukimi'},
{'yoshino', 'koharu', 'yukimi', 'arisu', 'yumi'},
{'yoshino', 'koharu', 'yukimi', 'yumi', 'arisu'},
{'yoshino', 'koharu', 'yumi', 'arisu', 'yukimi'},
{'yoshino', 'koharu', 'yumi', 'yukimi', 'arisu'},
{'yoshino', 'yukimi', 'arisu', 'koharu', 'yumi'},
{'yoshino', 'yukimi', 'arisu', 'yumi', 'koharu'},
{'yoshino', 'yukimi', 'koharu', 'arisu', 'yumi'},
{'yoshino', 'yukimi', 'koharu', 'yumi', 'arisu'},
{'yoshino', 'yukimi', 'yumi', 'arisu', 'koharu'},
{'yoshino', 'yukimi', 'yumi', 'koharu', 'arisu'},
{'yoshino', 'yumi', 'arisu', 'koharu', 'yukimi'},
{'yoshino', 'yumi', 'arisu', 'yukimi', 'koharu'},
{'yoshino', 'yumi', 'koharu', 'arisu', 'yukimi'},
{'yoshino', 'yumi', 'koharu', 'yukimi', 'arisu'},
{'yoshino', 'yumi', 'yukimi', 'arisu', 'koharu'},
{'yoshino', 'yumi', 'yukimi', 'koharu', 'arisu'},
{'yukimi', 'arisu', 'koharu', 'yoshino', 'yumi'},
{'yukimi', 'arisu', 'koharu', 'yumi', 'yoshino'},
{'yukimi', 'arisu', 'yoshino', 'koharu', 'yumi'},
{'yukimi', 'arisu', 'yoshino', 'yumi', 'koharu'},
{'yukimi', 'arisu', 'yumi', 'koharu', 'yoshino'},
{'yukimi', 'arisu', 'yumi', 'yoshino', 'koharu'},
{'yukimi', 'koharu', 'arisu', 'yoshino', 'yumi'},
{'yukimi', 'koharu', 'arisu', 'yumi', 'yoshino'},
{'yukimi', 'koharu', 'yoshino', 'arisu', 'yumi'},
{'yukimi', 'koharu', 'yoshino', 'yumi', 'arisu'},
{'yukimi', 'koharu', 'yumi', 'arisu', 'yoshino'},
{'yukimi', 'koharu', 'yumi', 'yoshino', 'arisu'},
{'yukimi', 'yoshino', 'arisu', 'koharu', 'yumi'},
{'yukimi', 'yoshino', 'arisu', 'yumi', 'koharu'},
{'yukimi', 'yoshino', 'koharu', 'arisu', 'yumi'},
{'yukimi', 'yoshino', 'koharu', 'yumi', 'arisu'},
{'yukimi', 'yoshino', 'yumi', 'arisu', 'koharu'},
{'yukimi', 'yoshino', 'yumi', 'koharu', 'arisu'},
{'yukimi', 'yumi', 'arisu', 'koharu', 'yoshino'},
{'yukimi', 'yumi', 'arisu', 'yoshino', 'koharu'},
{'yukimi', 'yumi', 'koharu', 'arisu', 'yoshino'},
{'yukimi', 'yumi', 'koharu', 'yoshino', 'arisu'},
{'yukimi', 'yumi', 'yoshino', 'arisu', 'koharu'},
{'yukimi', 'yumi', 'yoshino', 'koharu', 'arisu'},
{'yumi', 'arisu', 'koharu', 'yoshino', 'yukimi'},
{'yumi', 'arisu', 'koharu', 'yukimi', 'yoshino'},
{'yumi', 'arisu', 'yoshino', 'koharu', 'yukimi'},
{'yumi', 'arisu', 'yoshino', 'yukimi', 'koharu'},
{'yumi', 'arisu', 'yukimi', 'koharu', 'yoshino'},
{'yumi', 'arisu', 'yukimi', 'yoshino', 'koharu'},
{'yumi', 'koharu', 'arisu', 'yoshino', 'yukimi'},
{'yumi', 'koharu', 'arisu', 'yukimi', 'yoshino'},
{'yumi', 'koharu', 'yoshino', 'arisu', 'yukimi'},
{'yumi', 'koharu', 'yoshino', 'yukimi', 'arisu'},
{'yumi', 'koharu', 'yukimi', 'arisu', 'yoshino'},
{'yumi', 'koharu', 'yukimi', 'yoshino', 'arisu'},
{'yumi', 'yoshino', 'arisu', 'koharu', 'yukimi'},
{'yumi', 'yoshino', 'arisu', 'yukimi', 'koharu'},
{'yumi', 'yoshino', 'koharu', 'arisu', 'yukimi'},
{'yumi', 'yoshino', 'koharu', 'yukimi', 'arisu'},
{'yumi', 'yoshino', 'yukimi', 'arisu', 'koharu'},
{'yumi', 'yoshino', 'yukimi', 'koharu', 'arisu'},
{'yumi', 'yukimi', 'arisu', 'koharu', 'yoshino'},
{'yumi', 'yukimi', 'arisu', 'yoshino', 'koharu'},
{'yumi', 'yukimi', 'koharu', 'arisu', 'yoshino'},
{'yumi', 'yukimi', 'koharu', 'yoshino', 'arisu'},
{'yumi', 'yukimi', 'yoshino', 'arisu', 'koharu'},
{'yumi', 'yukimi', 'yoshino', 'koharu', 'arisu'}};


-- pre-defined functions 
function endless_vibrate()
	while 1 do 
	vibrate()
	usleep(1000000)
	end
end 

function down() 
touchDown(5, 909.60, 854.12);
usleep(84566.29);
touchUp(5, 909.60, 854.12);
end

function kettei() 
touchDown(2, 1843.36, 1027.13);
usleep(66662.83);
touchUp(2, 1843.36, 1027.13);
end

function start() 
touchDown(2, 1844.30, 1027.13);
usleep(98609.79);
touchUp(2, 1844.30, 1027.13);
end

function assistive() 
touchDown(4, 78.20, 655.02);
usleep(49974.29);
touchUp(4, 78.20, 655.02);
end

function controlpanel() 
touchDown(1, 1388.56, 772.93);
usleep(15095.29);
touchUp(1, 1388.56, 772.93);
end

function record() 
touchDown(3, 2155.24, 546.77);
usleep(116574.54);
touchUp(3, 2155.24, 546.77);
end

function home() 
keyDown(KEY_TYPE.HOME_BUTTON);
usleep(140158.67);
keyUp(KEY_TYPE.HOME_BUTTON);
end

function onoff() 
touchDown(5, 2025.86, 302.24);
usleep(101521.12);
touchUp(5, 2025.86, 302.24);
end

function wait(time)
usleep(time * 1000000)
end

function down() 
touchDown(5, 909.60, 854.12);
usleep(84566.29);
touchUp(5, 909.60, 854.12);
end

function kettei() 
touchDown(2, 1843.36, 1027.13);
usleep(66662.83);
touchUp(2, 1843.36, 1027.13);
end

function triple_home() 
keyDown(KEY_TYPE.HOME_BUTTON);
usleep(100088.00);
keyUp(KEY_TYPE.HOME_BUTTON);
usleep(60051.00);

keyDown(KEY_TYPE.HOME_BUTTON);
usleep(80075.00);
keyUp(KEY_TYPE.HOME_BUTTON);
usleep(60093.00);

keyDown(KEY_TYPE.HOME_BUTTON);
usleep(60012.00);
keyUp(KEY_TYPE.HOME_BUTTON);
end

function open_swap_palette()
	touchDown(5, 502.10, 610.56);
	usleep(83144.46);
	touchUp(5, 502.10, 610.56);
	usleep(2151893.88);

	touchDown(6, 634.41, 303.20);
	usleep(48388.50);
	touchUp(6, 634.41, 303.20);

end

function close_swap_palette()
touchDown(1, 97.50, 86.70);
usleep(66430.71);
touchUp(1, 97.50, 86.70);
end

function swap(i,j)
    swap_dict = {
		{611.23, 280.01},
		{859.40, 292.57},
		{1128.80, 338.97},
		{1329.63, 298.37},
		{1563.31, 321.57}
	}
	touchDown(2, swap_dict[i][1], swap_dict[i][2]);
	usleep(81898.79);
	touchUp(2, swap_dict[i][1], swap_dict[i][2]);
	usleep(701670.50);

	usleep(1500000)
	
	touchDown(3, swap_dict[j][1], swap_dict[j][2]);
	usleep(81898.79);
	touchUp(3, swap_dict[j][1], swap_dict[j][2]);
	usleep(701670.50);
	
	usleep(1500000)
	
	-- close confirmation dialog
	touchDown(4, 1307.43, 1058.06);
	usleep(84972.58);
	touchUp(4, 1307.43, 1058.06);
	usleep(500000)	
end

function assemble_idols(i)
	open_swap_palette()
	usleep(1000000)
    -- assemble the i+1th composition in matrix m 
    -- make copy of arrays of interst
    old_comp = m[i]
    new_comp = m[i+1]
    for j = 1,4 do
        if new_comp[j] ~= old_comp[j] then
            for k = 1,5 do
                if old_comp[k] == new_comp[j] then
                    swap(k,j)
					temp_storage = old_comp[k]
					old_comp[k] = old_comp[j]
					old_comp[j] = temp_storage
                end
            end
        end
    end
	usleep(1000000)
	close_swap_palette()
end

function assemble_costumes(i)

	costume_coord = {
		{513.69, 857.02},
		{842.02, 814.49},
		{1143.28, 808.69},
		{1396.27, 818.36},
		{1717.82, 796.13}
		}

	
	for j = 1,5 do
		-- set koharu's costume
		if m[i][j] == 'koharu' then
			-- click costume icon belonging to koharu
			touchDown(2, costume_coord[j][1], costume_coord[j][2]);
			usleep(64972.58);
			touchUp(2, costume_coord[j][1], costume_coord[j][2]);

			usleep(1000000)

			-- swap Koharu's costume to CD 
			touchUp(1, 1956.33, 568.03);
			usleep(220998.21);

			-- updated koharu costume 
			touchDown(2, 1942.81, 566.10);
			usleep(98202.62);
			touchUp(2, 1942.81, 566.10);
			usleep(1033806.04);

			touchDown(6, 1428.15, 372.79);
			usleep(99588.04);
			touchUp(6, 1428.15, 372.79);
			usleep(1000000);

			touchDown(2, 1160.67, 1104.45);
			usleep(82967.92);
			touchUp(2, 1160.67, 1104.45);
		
		-- arisu costume
		elseif m[i][j] == 'arisu' then
			touchDown(2, costume_coord[j][1], costume_coord[j][2]);
			usleep(64972.58);
			touchUp(2, costume_coord[j][1], costume_coord[j][2]);

			usleep(1000000)
			for k = 1,5 do
				if m[i][k] == 'yukimi' then
					if j + k == 6 then -- if arisu and yukimi are symmetric make arisu SSB
						touchDown(3, 468.31, 689.81);
						usleep(83024.88);
						touchUp(3, 468.31, 689.81);
						usleep(785883.96);

						touchDown(4, 1175.16, 1109.28);
						usleep(64750.25);
						touchUp(4, 1175.16, 1109.28);
						
						usleep(1000000);
					elseif j + k ~= 6 then -- make her SSB regardless, in this variant of the script
						touchDown(3, 468.31, 689.81);
						usleep(83024.88);
						touchUp(3, 468.31, 689.81);
						usleep(785883.96);

						touchDown(4, 1175.16, 1109.28);
						usleep(64750.25);
						touchUp(4, 1175.16, 1109.28);
					end
				end
			end
		
		elseif m[i][j] == 'yukimi' then 
			touchDown(2, costume_coord[j][1], costume_coord[j][2]);
			usleep(64972.58);
			touchUp(2, costume_coord[j][1], costume_coord[j][2]);
			usleep(1000000)

			touchDown(3, 468.31, 689.81);
			usleep(83024.88);
			touchUp(3, 468.31, 689.81);
			usleep(785883.96);

			touchDown(4, 1175.16, 1109.28);
			usleep(64750.25);
			touchUp(4, 1175.16, 1109.28);
		end
		usleep(1000000)
	end
end


-- function to extract 5 colors from the screen 
function extract_five_colors()
	color1 = tostring(getColor(513,534))
	color2 = tostring(getColor(850,517))
	color3 = tostring(getColor(1130,527))
	color4 = tostring(getColor(1435,523))
	color5 = tostring(getColor(1687,508))
	colorsum = color1 .. color2 .. color3 .. color4 .. color5
	return colorsum
end

-- function that takes as input a table containing int values representing 5 colors, and converts them into names
function get_index_from_colorsum(colorsum)
	colortable = {'6248061118925796241581539894616772521',
'6248061118925796241581160231404014977',
'62480611189257951362851005448016772521',
'62480611189257951362851602314012485217',
'62480611189257915254415100544804014977',
'62480611189257915254415539894612485217',
'6248061972398112747365539894616772521',
'6248061972398112747365160231404014977',
'6248061972398151362851353971016772521',
'6248061972398151362851602314015317657',
'6248061972398115254415135397104014977',
'6248061972398115254415539894615317657',
'62480617238850127473651005448016772521',
'62480617238850127473651602314012485217',
'6248061723885062415811353971016772521',
'6248061723885062415811602314015317657',
'62480617238850152544151353971012485217',
'62480617238850152544151005448015317657',
'62480611239761712747365100544804014977',
'62480611239761712747365539894612485217',
'6248061123976176241581135397104014977',
'6248061123976176241581539894615317657',
'62480611239761751362851353971012485217',
'62480611239761751362851005448015317657',
'1670549065783086241581539894616772521',
'1670549065783086241581160231404014977',
'16705490657830851362851005448016772521',
'16705490657830851362851602314012485217',
'16705490657830815254415100544804014977',
'16705490657830815254415539894612485217',
'1670549097239817564697539894616772521',
'1670549097239817564697160231404014977',
'16705490972398151362851038527616772521',
'1670549097239815136285160231409727612',
'16705490972398115254415103852764014977',
'1670549097239811525441553989469727612',
'16705490723885075646971005448016772521',
'16705490723885075646971602314012485217',
'16705490723885062415811038527616772521',
'1670549072388506241581160231409727612',
'167054907238850152544151038527612485217',
'16705490723885015254415100544809727612',
'16705490123976177564697100544804014977',
'16705490123976177564697539894612485217',
'16705490123976176241581103852764014977',
'1670549012397617624158153989469727612',
'167054901239761751362851038527612485217',
'16705490123976175136285100544809727612',
'10053459657830812747365539894616772521',
'10053459657830812747365160231404014977',
'10053459657830851362851353971016772521',
'10053459657830851362851602314015317657',
'10053459657830815254415135397104014977',
'10053459657830815254415539894615317657',
'10053459118925797564697539894616772521',
'10053459118925797564697160231404014977',
'100534591189257951362851038527616772521',
'10053459118925795136285160231409727612',
'100534591189257915254415103852764014977',
'10053459118925791525441553989469727612',
'10053459723885075646971353971016772521',
'10053459723885075646971602314015317657',
'100534597238850127473651038527616772521',
'10053459723885012747365160231409727612',
'100534597238850152544151038527615317657',
'10053459723885015254415135397109727612',
'10053459123976177564697135397104014977',
'10053459123976177564697539894615317657',
'100534591239761712747365103852764014977',
'10053459123976171274736553989469727612',
'100534591239761751362851038527615317657',
'10053459123976175136285135397109727612',
'50028936578308127473651005448016772521',
'50028936578308127473651602314012485217',
'5002893657830862415811353971016772521',
'5002893657830862415811602314015317657',
'50028936578308152544151353971012485217',
'50028936578308152544151005448015317657',
'50028931189257975646971005448016772521',
'50028931189257975646971602314012485217',
'50028931189257962415811038527616772521',
'5002893118925796241581160231409727612',
'500289311892579152544151038527612485217',
'50028931189257915254415100544809727612',
'5002893972398175646971353971016772521',
'5002893972398175646971602314015317657',
'50028939723981127473651038527616772521',
'5002893972398112747365160231409727612',
'50028939723981152544151038527615317657',
'5002893972398115254415135397109727612',
'50028931239761775646971353971012485217',
'50028931239761775646971005448015317657',
'500289312397617127473651038527612485217',
'50028931239761712747365100544809727612',
'50028931239761762415811038527615317657',
'5002893123976176241581135397109727612',
'15854553657830812747365100544804014977',
'15854553657830812747365539894612485217',
'1585455365783086241581135397104014977',
'1585455365783086241581539894615317657',
'15854553657830851362851353971012485217',
'15854553657830851362851005448015317657',
'15854553118925797564697100544804014977',
'15854553118925797564697539894612485217',
'15854553118925796241581103852764014977',
'1585455311892579624158153989469727612',
'158545531189257951362851038527612485217',
'15854553118925795136285100544809727612',
'1585455397239817564697135397104014977',
'1585455397239817564697539894615317657',
'15854553972398112747365103852764014977',
'1585455397239811274736553989469727612',
'15854553972398151362851038527615317657',
'1585455397239815136285135397109727612',
'15854553723885075646971353971012485217',
'15854553723885075646971005448015317657',
'158545537238850127473651038527612485217',
'15854553723885012747365100544809727612',
'15854553723885062415811038527615317657',
'1585455372388506241581135397109727612'}
	for i = 1,120 do 
		if colortable[i] == colorsum then
			return i 
		end
	end
	return 0 
end

-- function to make sure composition is correct
function assert_correct_composition(i)
	colortable = {'6248061118925796241581539894616772521',
'6248061118925796241581160231404014977',
'62480611189257951362851005448016772521',
'62480611189257951362851602314012485217',
'62480611189257915254415100544804014977',
'62480611189257915254415539894612485217',
'6248061972398112747365539894616772521',
'6248061972398112747365160231404014977',
'6248061972398151362851353971016772521',
'6248061972398151362851602314015317657',
'6248061972398115254415135397104014977',
'6248061972398115254415539894615317657',
'62480617238850127473651005448016772521',
'62480617238850127473651602314012485217',
'6248061723885062415811353971016772521',
'6248061723885062415811602314015317657',
'62480617238850152544151353971012485217',
'62480617238850152544151005448015317657',
'62480611239761712747365100544804014977',
'62480611239761712747365539894612485217',
'6248061123976176241581135397104014977',
'6248061123976176241581539894615317657',
'62480611239761751362851353971012485217',
'62480611239761751362851005448015317657',
'1670549065783086241581539894616772521',
'1670549065783086241581160231404014977',
'16705490657830851362851005448016772521',
'16705490657830851362851602314012485217',
'16705490657830815254415100544804014977',
'16705490657830815254415539894612485217',
'1670549097239817564697539894616772521',
'1670549097239817564697160231404014977',
'16705490972398151362851038527616772521',
'1670549097239815136285160231409727612',
'16705490972398115254415103852764014977',
'1670549097239811525441553989469727612',
'16705490723885075646971005448016772521',
'16705490723885075646971602314012485217',
'16705490723885062415811038527616772521',
'1670549072388506241581160231409727612',
'167054907238850152544151038527612485217',
'16705490723885015254415100544809727612',
'16705490123976177564697100544804014977',
'16705490123976177564697539894612485217',
'16705490123976176241581103852764014977',
'1670549012397617624158153989469727612',
'167054901239761751362851038527612485217',
'16705490123976175136285100544809727612',
'10053459657830812747365539894616772521',
'10053459657830812747365160231404014977',
'10053459657830851362851353971016772521',
'10053459657830851362851602314015317657',
'10053459657830815254415135397104014977',
'10053459657830815254415539894615317657',
'10053459118925797564697539894616772521',
'10053459118925797564697160231404014977',
'100534591189257951362851038527616772521',
'10053459118925795136285160231409727612',
'100534591189257915254415103852764014977',
'10053459118925791525441553989469727612',
'10053459723885075646971353971016772521',
'10053459723885075646971602314015317657',
'100534597238850127473651038527616772521',
'10053459723885012747365160231409727612',
'100534597238850152544151038527615317657',
'10053459723885015254415135397109727612',
'10053459123976177564697135397104014977',
'10053459123976177564697539894615317657',
'100534591239761712747365103852764014977',
'10053459123976171274736553989469727612',
'100534591239761751362851038527615317657',
'10053459123976175136285135397109727612',
'50028936578308127473651005448016772521',
'50028936578308127473651602314012485217',
'5002893657830862415811353971016772521',
'5002893657830862415811602314015317657',
'50028936578308152544151353971012485217',
'50028936578308152544151005448015317657',
'50028931189257975646971005448016772521',
'50028931189257975646971602314012485217',
'50028931189257962415811038527616772521',
'5002893118925796241581160231409727612',
'500289311892579152544151038527612485217',
'50028931189257915254415100544809727612',
'5002893972398175646971353971016772521',
'5002893972398175646971602314015317657',
'50028939723981127473651038527616772521',
'5002893972398112747365160231409727612',
'50028939723981152544151038527615317657',
'5002893972398115254415135397109727612',
'50028931239761775646971353971012485217',
'50028931239761775646971005448015317657',
'500289312397617127473651038527612485217',
'50028931239761712747365100544809727612',
'50028931239761762415811038527615317657',
'5002893123976176241581135397109727612',
'15854553657830812747365100544804014977',
'15854553657830812747365539894612485217',
'1585455365783086241581135397104014977',
'1585455365783086241581539894615317657',
'15854553657830851362851353971012485217',
'15854553657830851362851005448015317657',
'15854553118925797564697100544804014977',
'15854553118925797564697539894612485217',
'15854553118925796241581103852764014977',
'1585455311892579624158153989469727612',
'158545531189257951362851038527612485217',
'15854553118925795136285100544809727612',
'1585455397239817564697135397104014977',
'1585455397239817564697539894615317657',
'15854553972398112747365103852764014977',
'1585455397239811274736553989469727612',
'15854553972398151362851038527615317657',
'1585455397239815136285135397109727612',
'15854553723885075646971353971012485217',
'15854553723885075646971005448015317657',
'158545537238850127473651038527612485217',
'15854553723885012747365100544809727612',
'15854553723885062415811038527615317657',
'1585455372388506241581135397109727612'}
	if colortable[i] ~= extract_five_colors() then
		endless_vibrate()
	end
end

--check color to get initial starting point 
wait(3);
colorsum = extract_five_colors()
CURRENT = get_index_from_colorsum(colorsum)

--run script as usual, add a check for expected idol composition on screen 
i = CURRENT
w = 2

if i == 1 then -- initial, if first recording
	assemble_costumes(i);
	wait(w);
	triple_home();
	wait(w+1);
	assistive();
	wait(w-1);
	controlpanel();
	wait(w-1);
	record();
	wait(w-1)
	home();
	wait(w);
	triple_home();
	wait(w);
	start();
	for j = 1,33 do
	  wait(5);
	end
	triple_home();
	wait(w+1)
	assistive();
	wait(w-1);
	controlpanel();
	wait(w-1);
	record();
	wait(w-1)
	home();
	wait(w);
	triple_home();
	wait(10)
	kettei()
	wait(2)
end


while i ~= 120 do -- main loop
	assemble_idols(i)
	i = i + 1
	wait(w)
	assert_correct_composition(i)
	wait(w)
	assemble_costumes(i)
	wait(w-1);
	triple_home();
	wait(w)
	assistive();
	wait(w);
	controlpanel();
	wait(w-1);
	record();
	wait(w-1)
	home();
	wait(w);
	triple_home();
	wait(w);
	start();
	for j = 1,33 do
	  wait(5);
	end
	triple_home();
	wait(w+1)
	assistive();
	wait(w-1);
	controlpanel();
	wait(w-1);
	record();
	wait(w-1)
	home();
	wait(w);
	triple_home();
	wait(10)
	kettei()
	wait(8)
end